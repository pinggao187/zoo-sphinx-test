

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Generating Summary &mdash; analytics-zoo  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> analytics-zoo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">PythonAPI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zoo.automl.html">zoo.automl package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.common.html">zoo.common package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.examples.html">zoo.examples package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.feature.html">zoo.feature package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.models.html">zoo.models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.orca.html">zoo.orca package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.pipeline.html">zoo.pipeline package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.ray.html">zoo.ray package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.tfpark.html">zoo.tfpark package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.util.html">zoo.util package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoo.zouwu.html">zoo.zouwu package</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DockerUserGuide/index.html">Docker User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/install.html"><strong>Install the latest nightly build wheels for pip</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/install.html#install-from-pip-for-local-usage"><strong>Install from pip for local usage</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/install.html#install-from-pip-for-yarn-cluster"><strong>Install from pip for Yarn cluster</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/install.html#install-without-pip"><strong>Install without pip</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/run.html"><strong>Run after pip install</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/run.html#run-on-yarn-after-pip-install"><strong>Run on Yarn after pip install</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/run.html#run-without-pip-install"><strong>Run without pip install</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonUserGuide/run.html#example-code"><strong>Example code</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/python.html"><strong>Download Analytics Zoo Source Code</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/python.html#build-whl-package-for-pip-install"><strong>Build whl package for pip install</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/python.html#run-in-ide"><strong>Run in IDE</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html"><strong>Download a pre-built library</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#link-with-a-release-version"><strong>Link with a release version</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#link-with-a-development-version"><strong>Link with a development version</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#download-analytics-zoo-source"><strong>Download Analytics Zoo Source</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#setup-build-environment"><strong>Setup Build Environment</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#build-with-script-recommended"><strong>Build with script (Recommended)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#build-for-spark-1-6"><strong>Build for Spark 1.6</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#build-for-scala-2-10-or-2-11"><strong>Build for Scala 2.10 or 2.11</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#build-with-maven"><strong>Build with Maven</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/install.html#setup-ide"><strong>Setup IDE</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/run.html"><strong>Set Environment Variables</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/run.html#use-interactive-spark-shell"><strong>Use Interactive Spark Shell</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ScalaUserGuide/run.html#run-as-a-spark-program"><strong>Run as a Spark Program</strong></a></li>
</ul>
<p class="caption"><span class="caption-text">Programming Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nnframes.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnframes.html#examples">Examples:</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnframes.html#primary-apis">Primary APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="autograd.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="transferlearning.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html"><strong>Load and predict with pre-trained model</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html#examples"><strong>Examples</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch.html">System Requirement</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch.html#pytorch-api">Pytorch API</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch.html#examples">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="rayonspark.html"><strong>Introduction</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="rayonspark.html#steps-to-run-rayonspark"><strong>Steps to run RayOnSpark</strong></a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">analytics-zoo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Generating Summary</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ProgrammingGuide/visualization.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="generating-summary">
<h1>Generating Summary<a class="headerlink" href="#generating-summary" title="Permalink to this headline">¶</a></h1>
<p>To enable visualization support, you need first properly configure to collect statistics summary in different stages of training. It should be done before the training starts. See examples below:</p>
<div class="section" id="generating-summary-in-nnestimator">
<h2>Generating summary in NNEstimator<a class="headerlink" href="#generating-summary-in-nnestimator" title="Permalink to this headline">¶</a></h2>
<p><strong>scala</strong></p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">estimator</span> <span class="k">=</span> <span class="nc">NNEstimator</span><span class="o">(...)</span>
<span class="o">...</span>
<span class="k">val</span> <span class="n">logdir</span> <span class="k">=</span> <span class="s">&quot;mylogdir&quot;</span>
<span class="k">val</span> <span class="n">appName</span> <span class="k">=</span> <span class="s">&quot;myapp&quot;</span>
<span class="k">val</span> <span class="n">trainSummary</span> <span class="k">=</span> <span class="nc">TrainSummary</span><span class="o">(</span><span class="n">logdir</span><span class="o">,</span> <span class="n">appName</span><span class="o">)</span>
<span class="k">val</span> <span class="n">validationSummary</span> <span class="k">=</span> <span class="nc">ValidationSummary</span><span class="o">(</span><span class="n">logdir</span><span class="o">,</span> <span class="n">appName</span><span class="o">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">setTrainSummary</span><span class="o">(</span><span class="n">trainSummary</span><span class="o">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">setValidationSummary</span><span class="o">(</span><span class="n">validationSummary</span><span class="o">)</span>
<span class="o">...</span>
<span class="k">val</span> <span class="n">nnModel</span> <span class="k">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="o">(...)</span>
</pre></div>
</div>
<p><strong>python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bigdl.optim.optimizer</span> <span class="kn">import</span> <span class="n">TrainSummary</span><span class="p">,</span> <span class="n">ValidationSummary</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">NNEstimator</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">log_dir</span> <span class="o">=</span> <span class="s1">&#39;mylogdir&#39;</span>
<span class="n">app_name</span> <span class="o">=</span> <span class="s1">&#39;myapp&#39;</span>
<span class="n">train_summary</span> <span class="o">=</span> <span class="n">TrainSummary</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">)</span>
<span class="n">val_summary</span> <span class="o">=</span> <span class="n">ValidationSummary</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">set_train_summary</span><span class="p">(</span><span class="n">train_summary</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">set_val_summary</span><span class="p">(</span><span class="n">val_summary</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">nnModel</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generating-summary-in-keras-api">
<h2>Generating summary in Keras API<a class="headerlink" href="#generating-summary-in-keras-api" title="Permalink to this headline">¶</a></h2>
<p><strong>scala</strong></p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">model</span> <span class="k">=</span> <span class="o">[</span><span class="kt">...new</span> <span class="kt">keras</span> <span class="kt">model</span><span class="o">]</span>
<span class="o">...</span>
<span class="k">val</span> <span class="n">logdir</span> <span class="k">=</span> <span class="s">&quot;mylogdir&quot;</span>
<span class="k">val</span> <span class="n">appName</span> <span class="k">=</span> <span class="s">&quot;myapp&quot;</span>
<span class="n">model</span><span class="o">.</span><span class="n">setTensorBoard</span><span class="o">(</span><span class="n">logdir</span><span class="o">,</span> <span class="n">appName</span><span class="o">)</span>
<span class="o">...</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="o">(...)</span>
</pre></div>
</div>
<p><strong>python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="n">new</span> <span class="n">keras</span> <span class="n">model</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">log_dir</span> <span class="o">=</span> <span class="s1">&#39;mylogdir&#39;</span>
<span class="n">app_name</span> <span class="o">=</span> <span class="s1">&#39;myapp&#39;</span>
<span class="n">model</span><span class="o">.</span><span class="n">set_tensorboard</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generating-summary-in-kerasmodel">
<h2>Generating summary in KerasModel<a class="headerlink" href="#generating-summary-in-kerasmodel" title="Permalink to this headline">¶</a></h2>
<p><strong>python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">zoo.tfpark</span> <span class="kn">import</span> <span class="n">KerasModel</span>
<span class="kn">from</span> <span class="nn">bigdl.optim.optimizer</span> <span class="kn">import</span> <span class="n">TrainSummary</span><span class="p">,</span> <span class="n">ValidationSummary</span>

<span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="o">...</span><span class="n">new</span> <span class="n">keras</span> <span class="n">model</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KerasModel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="s2">&quot;mylogdir&quot;</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generating-summary-in-tfestimator">
<h2>Generating summary in TFEstimator<a class="headerlink" href="#generating-summary-in-tfestimator" title="Permalink to this headline">¶</a></h2>
<p><strong>python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">zoo.tfpark.estimator</span> <span class="kn">import</span> <span class="n">TFEstimator</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">TFEstimator</span><span class="o">.</span><span class="n">from_model_fn</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="s2">&quot;mylogdir&quot;</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Notice</strong>:</p>
<p>If logdir is relative path, like <code class="docutils literal notranslate"><span class="pre">logdir/inpcetion_log</span></code>, the log will be stored in your local file system;</p>
<p>If logdir is absolute path started with <code class="docutils literal notranslate"><span class="pre">/</span></code>, like <code class="docutils literal notranslate"><span class="pre">/user/logdir/inpcetion_log</span></code>, the log will be stored in your local file system;</p>
<p>If logdir is URI started with <code class="docutils literal notranslate"><span class="pre">hdfs://[host:port]/</span></code>, like <code class="docutils literal notranslate"><span class="pre">hdfs://172.168.0.101:8020/user/logdir/inpcetion_log</span></code>, the log will be stored to HDFS;</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="visualizing-training-with-tensorboard">
<h1>Visualizing training with TensorBoard<a class="headerlink" href="#visualizing-training-with-tensorboard" title="Permalink to this headline">¶</a></h1>
<p>With the summary info generated, we can then use <a class="reference external" href="https://pypi.python.org/pypi/tensorboard">TensorBoard</a> to visualize the behaviors of the training program.</p>
<div class="section" id="installing-tensorboard">
<h2><em>Installing TensorBoard</em><a class="headerlink" href="#installing-tensorboard" title="Permalink to this headline">¶</a></h2>
<p>Prerequisites:</p>
<ol class="simple">
<li>Python version: 3.6 or 3.7</li>
<li>Pip version &gt;= 9.0.1</li>
<li>TensorFlow 1.13.1</li>
</ol>
</div>
<div class="section" id="launching-tensorboard">
<h2><em>Launching TensorBoard</em><a class="headerlink" href="#launching-tensorboard" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading-from-local-directory">
<h3>Loading from local directory<a class="headerlink" href="#loading-from-local-directory" title="Permalink to this headline">¶</a></h3>
<p>You can launch TensorBoard using the command below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tensorboard --logdir<span class="o">=[</span>logdir path<span class="o">]</span>
</pre></div>
</div>
<p>After that, navigate to the TensorBoard dashboard using a browser. You can find the URL in the console output after TensorBoard is successfully launched; by default the URL is http://your_node:6006</p>
</div>
<div class="section" id="loading-from-hdfs">
<h3>Loading from HDFS<a class="headerlink" href="#loading-from-hdfs" title="Permalink to this headline">¶</a></h3>
<p>If the logdir is a HDFS folder, you need to configure the HDFS environment before running <code class="docutils literal notranslate"><span class="pre">tensorboard</span></code>.<br />Prerequisites:</p>
<ol class="simple">
<li>JDK &gt;= 1.8, Orcale JDK recommended</li>
<li>Hadoop &gt;= 2.7</li>
</ol>
<p>Set env before running <code class="docutils literal notranslate"><span class="pre">tensorboard</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export JAVA_HOME=[your java home path]
export HADOOP_HOME=[your hadoop home path]
source ${HADOOP_HOME}/libexec/hadoop-config.sh
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${JAVA_HOME}/jre/lib/amd64/server
</pre></div>
</div>
<p>If the Hadoop cluster is in secure mode, also set the environment variable <code class="docutils literal notranslate"><span class="pre">KRB5CCNAME</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">KRB5CCNAME</span><span class="o">=</span><span class="p">{</span><span class="n">Path</span> <span class="n">of</span> <span class="n">Kerberos</span> <span class="n">ticket</span> <span class="n">cache</span> <span class="n">file</span><span class="p">}</span>
</pre></div>
</div>
<p>Run tensorboard, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CLASSPATH=$(${HADOOP_HOME}/bin/hadoop classpath --glob) tensorboard --logdir=hdfs://[ip:port]/[hdfs path]
</pre></div>
</div>
</div>
</div>
<div class="section" id="visualizations-in-tensorboard">
<h2><em>Visualizations in TensorBoard</em><a class="headerlink" href="#visualizations-in-tensorboard" title="Permalink to this headline">¶</a></h2>
<p>Within the TensorBoard dashboard, you will be able to read the visualizations of each run, including the “Loss” and “Throughput” curves under the SCALARS tab (as illustrated below):
<img alt="Scalar" src="ProgrammingGuide/../Image/tensorboard-scalar.png" /></p>
<p>And “weights”, “bias”, “gradientWeights” and “gradientBias” under the DISTRIBUTIONS and HISTOGRAMS tabs (as illustrated below):
<img alt="histogram1" src="ProgrammingGuide/../Image/tensorboard-histo1.png" />
<img alt="histogram2" src="ProgrammingGuide/../Image/tensorboard-histo2.png" />
As getting DISTRIBUTIONS and HISTOGRAMS may affect the training performance, so we don’t enable this option by default. For example you want to fetch this parameters every 20 iteartions, you should call <code class="docutils literal notranslate"><span class="pre">trainSummary.setSummaryTrigger(&quot;Parameters&quot;,</span> <span class="pre">Trigger.severalIteration(20))</span></code>(<code class="docutils literal notranslate"><span class="pre">set_summary_trigger</span></code> in python API) before calling <code class="docutils literal notranslate"><span class="pre">setTrainSummary</span></code>.</p>
</div>
<hr class="docutils" />
<div class="section" id="retrieving-summary-from-build-in-api">
<h2>Retrieving summary from build-in API<a class="headerlink" href="#retrieving-summary-from-build-in-api" title="Permalink to this headline">¶</a></h2>
<p>You can use provided API to retrieve the summaries into readable format, and export them to other tools for further analysis or visualization.</p>
<p>Please note this approach does not work for KerasModel and TFEstimator.</p>
<ul class="simple">
<li><em><strong>Example: Reading summary info in NNestimator</strong></em></li>
</ul>
<p><strong>scala</strong></p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">estimator</span> <span class="k">=</span> <span class="nc">NNEstimator</span><span class="o">(...)</span>
<span class="o">...</span>
<span class="k">val</span> <span class="n">logdir</span> <span class="k">=</span> <span class="s">&quot;mylogdir&quot;</span>
<span class="k">val</span> <span class="n">appName</span> <span class="k">=</span> <span class="s">&quot;myapp&quot;</span>
<span class="k">val</span> <span class="n">trainSummary</span> <span class="k">=</span> <span class="nc">TrainSummary</span><span class="o">(</span><span class="n">logdir</span><span class="o">,</span> <span class="n">appName</span><span class="o">)</span>
<span class="k">val</span> <span class="n">validationSummary</span> <span class="k">=</span> <span class="nc">ValidationSummary</span><span class="o">(</span><span class="n">logdir</span><span class="o">,</span> <span class="n">appName</span><span class="o">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">setTrainSummary</span><span class="o">(</span><span class="n">trainSummary</span><span class="o">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">setValidationSummary</span><span class="o">(</span><span class="n">validationSummary</span><span class="o">)</span>
<span class="o">...</span>
<span class="k">val</span> <span class="n">nnModel</span> <span class="k">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="o">(...)</span>
<span class="k">val</span> <span class="n">trainLoss</span> <span class="k">=</span> <span class="n">trainSummary</span><span class="o">.</span><span class="n">readScalar</span><span class="o">(</span><span class="s">&quot;Loss&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">valLoss</span> <span class="k">=</span> <span class="n">validationSummary</span><span class="o">.</span><span class="n">readScalar</span><span class="o">(</span><span class="s">&quot;Loss&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p><strong>python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bigdl.optim.optimizer</span> <span class="kn">import</span> <span class="n">TrainSummary</span><span class="p">,</span> <span class="n">ValidationSummary</span>

<span class="n">estimator</span> <span class="o">=</span> <span class="n">NNEstimator</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">log_dir</span> <span class="o">=</span> <span class="s1">&#39;mylogdir&#39;</span>
<span class="n">app_name</span> <span class="o">=</span> <span class="s1">&#39;myapp&#39;</span>
<span class="n">train_summary</span> <span class="o">=</span> <span class="n">TrainSummary</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">)</span>
<span class="n">val_summary</span> <span class="o">=</span> <span class="n">ValidationSummary</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="n">app_name</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">set_train_summary</span><span class="p">(</span><span class="n">train_summary</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">set_val_summary</span><span class="p">(</span><span class="n">val_summary</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">train_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_summary</span><span class="o">.</span><span class="n">read_scalar</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">))</span>
<span class="n">val_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val_summary</span><span class="o">.</span><span class="n">read_scalar</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">))</span>
</pre></div>
</div>
<ul class="simple">
<li><em><strong>Example: Reading summary info in keras API</strong></em></li>
</ul>
<p><strong>scala</strong></p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">trainLoss</span> <span class="k">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getTrainSummary</span><span class="o">(</span><span class="s">&quot;loss&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">valLoss</span> <span class="k">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getValidationSummary</span><span class="o">(</span><span class="s">&quot;loss&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p><strong>python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_train_summary</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="n">val_loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_validation_summary</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If your training job has finished and existed, but a new program wants retrieving summary with <code class="docutils literal notranslate"><span class="pre">readScalar</span></code>(<code class="docutils literal notranslate"><span class="pre">read_scalar</span></code> in python) API.
You can re-create the TrainingSummary and ValidationSummary with the same <code class="docutils literal notranslate"><span class="pre">logDir</span></code> and <code class="docutils literal notranslate"><span class="pre">appName</span></code> in your new job.</p>
</div>
<hr class="docutils" />
<div class="section" id="visualizing-training-with-jupyter-notebook">
<h2>Visualizing training with Jupyter notebook<a class="headerlink" href="#visualizing-training-with-jupyter-notebook" title="Permalink to this headline">¶</a></h2>
<p>If you’re using Jupyter notebook, you can also draw the training curves using popular plotting tools (e.g. matplotlib) and show the plots inline.</p>
<p>First, retrieve the summaries as instructed in <a class="reference external" href="#retrieving-summary-from-build-in-api">Retrieve Summary</a>. The retrieved summary is a list of tuples. Each tuple is a recorded event in format (iteration count, recorded value, timestamp). You can convert it to numpy array or dataframe to plot it. See example below:</p>
<p>Please note this approach does not work for KerasModel and TFEstimator.</p>
<ul class="simple">
<li><em><strong>Example: Plot the train/validation loss in Jupyter</strong></em></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#retrieve train and validation summary object and read the loss data into ndarray&#39;s. </span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_summary</span><span class="o">.</span><span class="n">read_scalar</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">))</span>
<span class="n">val_loss</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val_summary</span><span class="o">.</span><span class="n">read_scalar</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">))</span>

<span class="c1">#plot the train and validation curves</span>
<span class="c1"># each event data is a tuple in form of (iteration_count, value, timestamp)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">loss</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">loss</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;train loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_loss</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">val_loss</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;val loss&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">val_loss</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">val_loss</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<p><img alt="jupyter" src="ProgrammingGuide/../Image/jupyter.png" /></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Intel

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>